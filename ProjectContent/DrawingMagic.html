
<style>
    .draw-vid
    {
        width:75%; 
        height:75%;
    }
</style>

<!-- Todo: Check if these texts can be shortened. -->

<h1>Drawing Magic</h1>

<h3>Overview</h3>

<p> 
    This project is my midterm exam and it has multiple things to offer. Much on the programming side but also a little bit of art.
    There are two main aspects of the game. The first is an adorable blob which follows you around and might even prove useful.
</p>
<br>
<p style="text-align: center">
    <b>Spoiler Alert!</b> The following video demonstrates the solution to a puzzle.
</p>
<div class="mar-top; mar-bottom"style="padding-left: 20%">
    <div class="overlays"><i id="key_o" class="fa fa-fw fa-play vid-play"></i></div>
    <video  
        class="video draw-vid" id="key" 
        onclick="TogglePlay('key');"  onplay="ShowPlay('key', false)" onpause="ShowPlay('key', true)" onended="ShowPlay('key', true); Reset('key')" 
        type="video/x-webm" src="Media/DrawingMagic/FetchKey.webm">
    </video>
</div>


<p>
    The second aspect of the game is the ability to draw magic lines into the air. 
    Currently that's all, but I have created an idea on how to use machine learning to recognize symbols which could be combined for powerful spells.
</p>
<div class="mar-top; mar-bottom"style="padding-left: 20%">
    <div class="overlays"><i id="drawVid_o" class="fa fa-fw fa-play vid-play"></i></div>
    <video  
        class="video draw-vid" id="drawVid" 
        onclick="TogglePlay('drawVid');"  onplay="ShowPlay('drawVid', false)" onpause="ShowPlay('drawVid', true)" onended="ShowPlay('drawVid', true); Reset('drawVid')" 
        type="video/x-webm" src="Media/DrawingMagic/Drawing.webm">
    </video>
</div>

<h3 id="blob">Blob Character</h3>

<p>
    When looking for a softbody script I found two free variants. One didn't look good and another slowed the school PCs to a halt. 
    Knowing all too well that I could never create anything close to a simulation I just experimented with a custom approach.
    Since my ideas developed while writing code it admittedly got a little messy, but the core idea is easy to explain:
    <br><br>
    The blob has a small sphere collider for actual physics and a trigger the exact size of its mesh, which registers intersections.
    For each intersection, the closest point to the blob's center is calculated. 
    Each point then pushes the vertices away in the direction of the collision normal. 
    The closer point and vertex are in normal direction, the stronger this squash effect is.
    Vertices are also pushed away perpendicular to the normal, which simultaneously creates a stretch effect.<br>
    All this is used to calculate a velocity for each vertex. The further a vertex is away from its original position, the stronger it will be pushed back to it.
    Imagine each vertex being a spring connected to the blob's center.

</p>

<div class="mar-top; mar-bottom"style="padding-left: 20%">
    <div class="overlays"><i id="softbody_o" class="fa fa-fw fa-play vid-play"></i></div>
    <video  
        class="video draw-vid" id="softbody" 
        onclick="TogglePlay('softbody');"  onplay="ShowPlay('softbody', false)" onpause="ShowPlay('softbody', true)" onended="ShowPlay('softbody', true); Reset('softbody')" 
        type="video/x-webm" src="Media/DrawingMagic/SoftbodyTesting.webm">
    </video>    
</div>

<p>
    After making the blob controllable I added some 'flavor' like giving it a tear shape when it is moving very fast or jumping. 
    The eyes also behave differently depending on how fast the player moves, how far he turns, if he is squashed below an object etc.
</p>

<div class="mar-top; mar-bottom"style="padding-left: 20%">
    <div class="overlays"><i id="blobPlayer_o" class="fa fa-fw fa-play vid-play"></i></div>
    <video  
        class="video draw-vid" id="blobPlayer" 
        onclick="TogglePlay('blobPlayer');"  onplay="ShowPlay('blobPlayer', false)" onpause="ShowPlay('blobPlayer', true)" onended="ShowPlay('blobPlayer', true); Reset('blobPlayer')" 
        type="video/x-webm" src="Media/DrawingMagic/BlobPlayer.webm">
    </video>
</div>

<h3 id="pathfinding">Custom 'Pathfinding'</h3>

<p>
    Even after the movement controls were completed, the gameplay concept was pretty rough. It was supposed to be a platformer with gravity similar to Mario Galaxy. 
    The blob would grow when eating things and shrink when being bitten by enemies. Eventually, he would be able to swallow the level and fall onto another planet.
    Instead of implementing this, I had a completely different idea. In order to somehow recycle what I did so far, I made the blob an NPC and developed a simple 'pathfinder'.
<br><br>
    Transforms marked with a gem symbol are saved in an array. Some of them are marked as key-points (here they are yellow). 
    The blob will always move to the key-point which is closest to the player (black capsule).
    He will not move directly to it, however, but always move from one point in the array to the next, until he has reached his destination.
</p>

<div class="mar-top; mar-bottom"style="padding-left: 20%">
    <div class="overlays"><i id="path_o" class="fa fa-fw fa-play vid-play"></i></div>
    <video  
        class="video draw-vid" id="path" 
        onclick="TogglePlay('path');"  onplay="ShowPlay('path', false)" onpause="ShowPlay('path', true)" onended="ShowPlay('path', true); Reset('path')" 
        type="video/x-webm" src="Media/DrawingMagic/Pathfinding.webm">
    </video>
</div>



<h3 id="draw">Drawing</h3>

<p>
    Actually learning spells by memorizing symbols and having the immersive experience of actually drawing them. 
    Experiment with what you saw and create something completely new! 
    <br>
    That was the goal of this project. It could be implemented with machine learning. 
    The player can draw anything he or she wants and enjoy various colorful effects. 
    An AI would be easily confused with the extras so it gets the output of another camera which gets just the core information.
    <br><br>
    The first picture is what the player sees. Many moving objects, a Line Renderer component with a varying thickness, a color gradient, and a glow. <br>
    On the other picture, there is just one thing: a Line Renderer with the exact same form as the one before but with maximum contrast and perfect for machine learning.

</p>
<img src="Media/DrawingMagic/NormalCam.PNG" class="myImg" style="margin-bottom:0px">
<img src="Media/DrawingMagic/NeuralCam.PNG" class="myImg" style="margin-top:20px">

<p>
    Due to time constraints of the exam (two weeks full time) and later the distraction through other topics, the mechanic was never implemented.
    I expected this to happen but still wanted to see, how far I could get. In the end, I'm happy about the result.
    <br>
    Maybe I will recreate this project in VR some day. On the next image, you can see how combining spells might work.
    The big circle determines the element (fire), the top-right one the direction (forward) and the circle in the bottom-left the form (condensed).
    A fireball would be created!
</p>




<img src="Media/DrawingMagic/SpellCircle.png" class="myImg">
    <br>

    <p class="tool-head"><b>Resource used:</b></p>
    <a href="https://catlikecoding.com/unity/tutorials/mesh-deformation/">
            <p class="tool">Catlike Coding on Mesh Deformation</p>
    </a>

    <div>
        <a href="https://bitbucket.org/gongfumaniac/drawingmagic/src/master/">
            <div class ="w3-container git-container" > 
                <p class="git" >View Repository<br><i class=git-subtext>(Main)</i></p>
            </div>
        </a>
    
    
        <a href="https://bitbucket.org/gongfumaniac/consume/src">
            <div class ="w3-container git-container" > 
                <p class="git" >View Repository<br><i class=git-subtext>(Blob Player)</i></p>
            </div>
        </a>
    </div>
</p>